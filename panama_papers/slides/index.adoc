:revealjs_width: '100%'
:revealjs_customtheme: ../themes/neo4j/style/main.css
:author: Benoit Simard (@logisima)

= Plongez dans les panama papers avec Neo4j

== Introduction

[class="split5050"]
=== Benoit Simard

image::assets/me.JPG[height=500]

* Consultant Neo4j
* benoit.simard@neotechnology.com
* @logisima
* Addicte aux graphes
* Formateur

=== Les sources de données

Les sources de données de cette présentation proviennent des endroits suivants 

* Les présentations de l'ICIJ 
** Graph Connect Londre
** Sud-web
* https://www.reddit.com/r/IAmA/comments/4fi6ck/we_are_the_investigative_journalists_who_worked/[Reddit]
* https://panamapapers.icij.org/

== L'histoire

=== L'origine

image::assets/source.jpg[]

=== La volumétrie

C'est la plus large fuite de données de l'histoire, et de loin !

image::assets/amount_of_data.png[width=800]

=== ICIJ

**~190 journalistes dans plus de 65 pays**

image::assets/icij.png[]

Equipe de 12 personnes à temps plein (USA, Costa Rica, Venezuela, Germany, France, Spain) dont 50% travaillent sur l'analyse des données.

== Les outils

=== Le processus

[graphviz]
----
digraph finite_state_machine {
  rankdir=TB;
  node [ fontsize=20, shape = Mrecord];
  edge [ fontsize=20 ];

    "Fichier brut";
    "Texte brut";
    "Métadonnées";
    "Base de données";
    "Explorer / Analyser";

    "Fichier brut" -> "Texte brut";
    "Fichier brut" -> "Métadonnées";
    "Texte brut" -> "Base de données";
    "Métadonnées" -> "Base de données";
    "Base de données" -> "Explorer / Analyser";
}
----

=== Le cloud à la rescousse

Utilisation de Niux OCR pour récupérer le texte des documents, ainsi que d'autres outils pour établir des références croisées entre des millions de documents sur le nom des clients de Mossack Fonseca.

image::assets/processing-time.png[height=400]

* 3 millions de fichiers x 10 secondes/fichier => **1 année**
* 1 année / 35 serveurs => **1,5 semaine**

=== Blacklight

Projet open-source de gestion des catalogues de bibliothèque, permettant de réaliser des **requêtes solr**

image::assets/blacklight.png[]

=== La stack technique

* **Extraction des données non structurées :** Nuix OCR, ICIJ Extract (open source, Java: https://github.com/ICIJ/extract), leverages Apache Tika, Tesseract OCR and JBIG2-ImageIO.

* **Extraction des données structurées :**  un peu de Python

* **Base de données :** Apache Solr (open source, Java), Redis (open source, C), Neo4j (open source, Java)

* **Application :** Blacklight (open source, Rails), Linkurious (closed source, JS)

=== Linkurious

image::assets/linkurious.png[]

== Comment lier les données ?

=== Des documents déconnectées

image::assets/disconnected.png[width=1000]

=== Des données connectées ?

image::assets/graph.png[width=1000]

=== C'est une histoire de contexte

image::assets/graph1.png[width=1000]

[class="split5050"]
=== (graph)-[:ARE]->(everywhere)

**Le monde est un graph, tout est connecté !**

image::assets/world-graph.png[]

* les personnes, les lieux, les évènements
* Les entreprises, le marché, les clients
* les pays, l'histoire, les politiques
* technologie, les réseaux, les machines, les utilisateurs
* les applications, le code, les dépendances, l'architecture, le déploiement
* ...

== Stocker & requêter

=== Le graphe

image::assets/neo4j.png[]

[class="split5050"]
=== Modélisation en graphe

image::assets/graph-model.png[]

**Les noeuds**

* Les entités du graphe
* Peuvent avoir des propriétés
* Peuvent avoir des labels (étiquettes)


**Les relations**

* Relient des noeuds avec un type et une direction
* Peuvent avoir des propriétés

=== Tout est pattern

image::assets/cypher-pattern.png[]

=== Les étapes à l'analyse des données

. Obtenir les documents
. Classifier les documents (Scan, OCR, métadonnées)
. Etablir une modélisation avec les entités, leurs relations et les propriétés
. Développer des analyseurs, des parseurs, des règles permettant de récupérer les noms des entités
. Parser les documents et stocker les données trouvées ainsi que les méta-données
. Déduire les relations entre les entités (grace au contexte)
. Calculer les similitudes, trouver les realtions transitivités, triangulaire
. Analyser (cypher) et explorer (Linkurious)

== Les Panama Papers

[class="split5050"]
=== Le modèle

image::assets/panama-model.png[]

* Modèle simpliste (4 entités et 5 relations)
* On ne connait que le modèle publié
* Il manque : les documents, les metadatas, les relations familliales
* Les connections aux données publiques (opendata)
* Contient des doublons
* Les informations de relation sont stockées sur les entités

=== Exemple : Président Azerbaijan - Ilham Aliyev

image::assets/azerbaijan.jpg[]

== Pour aller plus loin

=== Suivez le guide

**A taper dans le browser Neo4j**

[source,shell]
----
:play http://guides.neo4j.com/graphgist/panama_papers.html
----

=== Chargez les données !

https://offshoreleaks.icij.org/pages/database

[source, shell]
----
./neo4j-community-3.0.1/bin/neo4j-import --into graph.db \
  --nodes:Address ${data_dir}/Addresses.csv \
  --nodes:Entity ${data_dir}/Entities.csv \
  --nodes:Intermediary ${data_dir}/Intermediaries.csv \
  --nodes:Officer ${data_dir}/Officers.csv \
  --relationships ${data_dir}/all_edges_header.csv,${data_dir}/all_edges.csv \
  --ignore-empty-strings true \
  --skip-duplicate-nodes true \
  --skip-bad-relationships true \
  --bad-tolerance  1500 \
  --multiline-fields=true
----

=== En savoir plus

* **Neo4j Blog**
** http://neo4j.com/blog/panama-papers/
** http://neo4j.com/blog/analyzing-panama-papers-neo4j/

* **ICIJ**
** https://panamapapers.icij.org/
** https://panamapapers.icij.org/the_power_players/
** https://panamapapers.icij.org/graphs/

* **SZ**
** http://panamapapers.sueddeutsche.de/en/

* **Guardian**
** http://www.theguardian.com/news/series/panama-papers

== Merci

=== Des questions ?

* **Twitter:** Suivez les comptes @neojFr & @neo4j
* **Google group :**  Avec les groupes Neo4jFr & Neo4j
* **Stackoverflow :**  avec les tags neo4j & cypher
* **Slack :** http://neo4j-users-slack-invite.herokuapp.com/

image::assets/questions.png[]
